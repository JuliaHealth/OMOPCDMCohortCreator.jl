<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Beginner Tutorial ğŸ£ Â· OMOPCDMCohortCreator.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://JuliaHealth.github.io/OMOPCDMCohortCreator.jl/tutorials/beginner_tutorial/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OMOPCDMCohortCreator.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../">Tutorials</a></li><li class="is-active"><a class="tocitem" href>Beginner Tutorial ğŸ£</a><ul class="internal"><li><a class="tocitem" href="#Environment-Set-Up"><span>Environment Set-Up ğŸ“</span></a></li><li><a class="tocitem" href="#Connecting-to-the-Eunomia-Database"><span>Connecting to the Eunomia Database ğŸ’¾</span></a></li><li><a class="tocitem" href="#Characterizing-Patients-Who-Have-Had-Strep-Throat"><span>Characterizing Patients Who Have Had Strep Throat ğŸ¤’</span></a></li><li><a class="tocitem" href="#Conclusion"><span>Conclusion ğŸ‰</span></a></li><li><a class="tocitem" href="#Appendix"><span>Appendix ğŸ•µï¸</span></a></li></ul></li><li><a class="tocitem" href="../r_tutorial/">Using OMOPCDMCohortCreator with R ğŸ´â€â˜ ï¸</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Beginner Tutorial ğŸ£</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Beginner Tutorial ğŸ£</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl/blob/dev/docs/src/tutorials/beginner_tutorial.md#L" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Beginner-Tutorial"><a class="docs-heading-anchor" href="#Beginner-Tutorial">Beginner Tutorial ğŸ£</a><a id="Beginner-Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Beginner-Tutorial" title="Permalink"></a></h1><ul><li><a href="#Beginner-Tutorial">Beginner Tutorial ğŸ£</a></li><li class="no-marker"><ul><li><a href="#Environment-Set-Up">Environment Set-Up ğŸ“</a></li><li><a href="#Connecting-to-the-Eunomia-Database">Connecting to the Eunomia Database ğŸ’¾</a></li><li><a href="#Characterizing-Patients-Who-Have-Had-Strep-Throat">Characterizing Patients Who Have Had Strep Throat ğŸ¤’</a></li><li><a href="#Conclusion">Conclusion ğŸ‰</a></li><li><a href="#Appendix">Appendix ğŸ•µï¸</a></li></ul></li></ul><p>This tutorial presents a step by step guide on using OMOPCDMCohortCreator to run a mini characterization study! You will learn the basics of OMOPCDMCohortCreator and how to use it with fake data that you could then apply to your real data sets. Basic knowledge of Julia (such as installing packages into environments and working with the Julia REPL and Julia files) is necessary; you can learn all <a href="https://pkgdocs.julialang.org/v1/getting-started/">that here</a>.</p><h2 id="Environment-Set-Up"><a class="docs-heading-anchor" href="#Environment-Set-Up">Environment Set-Up ğŸ“</a><a id="Environment-Set-Up-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Set-Up" title="Permalink"></a></h2><p>For this tutorial, you will need to activate an environment; to get into package mode within your Julia REPL, write <code>]</code>:</p><pre><code class="language-julia-repl hljs">pkg&gt; activate TUTORIAL</code></pre><h3 id="Packages"><a class="docs-heading-anchor" href="#Packages">Packages</a><a id="Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Packages" title="Permalink"></a></h3><p>You will need the following packages for this tutorial which you can install in package mode:</p><pre><code class="language-julia-repl hljs">TUTORIAL&gt; add OMOPCDMCohortCreator
TUTORIAL&gt; add SQLite
TUTORIAL&gt; add DataFrames
TURORIAL&gt; add HealthSampleData</code></pre><p>To learn more about these packages, see the <a href="#appendix">Appendix</a>.</p><h3 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h3><p>For this tutorial, we will work with data from <a href="https://github.com/OHDSI/Eunomia">Eunomia</a> that is stored in a SQLite format. To install the data on your machine, execute the following code block and follow the prompts - you will need a stable internet connection for the download to complete: </p><pre><code class="language-julia hljs">import HealthSampleData: Eunomia

eunomia = Eunomia()</code></pre><h2 id="Connecting-to-the-Eunomia-Database"><a class="docs-heading-anchor" href="#Connecting-to-the-Eunomia-Database">Connecting to the Eunomia Database ğŸ’¾</a><a id="Connecting-to-the-Eunomia-Database-1"></a><a class="docs-heading-anchor-permalink" href="#Connecting-to-the-Eunomia-Database" title="Permalink"></a></h2><p>After you have finished your set up in the Julia, we need to establish a connection to the Eunomia SQLite database that we will use for the rest of the tutorial: </p><pre><code class="language-julia hljs">import SQLite: DB

conn = DB(eunomia)</code></pre><p>With Eunomia, the database&#39;s schema is simply called &quot;main&quot;. We will use this to generate database connection details that will inform <code>OMOPCDMCohortCreator</code> about the type of queries we will write (i.e. SQLite) and the name of the database&#39;s schema. For this step, we will use <code>OMOPCDMCohortCreator</code>:</p><pre><code class="language-julia hljs">import OMOPCDMCohortCreator as occ

occ.GenerateDatabaseDetails(
    :sqlite,
    &quot;main&quot;
)</code></pre><p>Finally, we will generate internal representations of each table found within Eunomia for OMOPCDMCohortCreator to use:</p><pre><code class="language-julia hljs">occ.GenerateTables(conn)</code></pre><p>As a check to make sure everything was correctly installed and works properly, the following block should work and return a list of all person ids in this data:</p><pre><code class="language-julia hljs">occ.GetDatabasePersonIDs(conn)</code></pre><h2 id="Characterizing-Patients-Who-Have-Had-Strep-Throat"><a class="docs-heading-anchor" href="#Characterizing-Patients-Who-Have-Had-Strep-Throat">Characterizing Patients Who Have Had Strep Throat ğŸ¤’</a><a id="Characterizing-Patients-Who-Have-Had-Strep-Throat-1"></a><a class="docs-heading-anchor-permalink" href="#Characterizing-Patients-Who-Have-Had-Strep-Throat" title="Permalink"></a></h2><h3 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h3><p>As all the tools are working properly, let&#39;s do what is called a characterization study - a study that <em>characterizes</em> a group of patients with a certain condition (or conditions) across various attributes like race, age, and combinations thereof. We are going to do miniature version of such a study looking at patients with strep throat. For this, we will use the <code>condition_concept_id</code>: <span>$28060$</span> - this will be needed for you to get correct results.</p><blockquote><p><strong>NOTE:</strong> As we go through this example, do not immediately jump to the code block required but try to use the <a href="../../api/#API">API</a> to come up with solutions as there may be more than one answer.</p></blockquote><h3 id="Task:-Find-All-Patients-with-Strep-Throat"><a class="docs-heading-anchor" href="#Task:-Find-All-Patients-with-Strep-Throat">Task: Find All Patients with Strep Throat</a><a id="Task:-Find-All-Patients-with-Strep-Throat-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Find-All-Patients-with-Strep-Throat" title="Permalink"></a></h3><p>Using the <a href="../../api/#API">API</a>, find all patients with strep throat.</p><p>Suggested solution:</p><pre><code class="language-julia hljs">strep_patients = occ.ConditionFilterPersonIDs(28060, conn)</code></pre><h3 id="Task:-Find-the-Race-of-Patients-with-Strep-Throat"><a class="docs-heading-anchor" href="#Task:-Find-the-Race-of-Patients-with-Strep-Throat">Task: Find the Race of Patients with Strep Throat</a><a id="Task:-Find-the-Race-of-Patients-with-Strep-Throat-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Find-the-Race-of-Patients-with-Strep-Throat" title="Permalink"></a></h3><p>For the patients who have strep throat diagnoses, find their race.</p><p>Suggested solution:</p><pre><code class="language-julia hljs">strep_patients_race = occ.GetPatientRace(strep_patients, conn)</code></pre><h3 id="Task:-Find-the-Gender-of-Patients-with-Strep-Throat"><a class="docs-heading-anchor" href="#Task:-Find-the-Gender-of-Patients-with-Strep-Throat">Task: Find the Gender of Patients with Strep Throat</a><a id="Task:-Find-the-Gender-of-Patients-with-Strep-Throat-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Find-the-Gender-of-Patients-with-Strep-Throat" title="Permalink"></a></h3><p>For the patients who have strep throat diagnoses, find their gender.</p><p>Suggested solution:</p><pre><code class="language-julia hljs">strep_patients_gender = occ.GetPatientGender(strep_patients, conn)</code></pre><h3 id="Task:-Create-Age-Groupings-of-Patients-with-Strep-Throat"><a class="docs-heading-anchor" href="#Task:-Create-Age-Groupings-of-Patients-with-Strep-Throat">Task: Create Age Groupings of Patients with Strep Throat</a><a id="Task:-Create-Age-Groupings-of-Patients-with-Strep-Throat-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Create-Age-Groupings-of-Patients-with-Strep-Throat" title="Permalink"></a></h3><p>For this task, for every single person who has a strep throat diagnosis, assign them an age group. The age groupings must follow <span>$5$</span> year intervals when assigned to a person up to <span>$100$</span> years of age (e.g. <span>$[0, 4], [5, 9], ... [95, 100]$</span>).</p><p>Suggested solution:</p><pre><code class="language-julia hljs">age_groups = [
	[0, 4],
	[5, 9],
	[10, 14],
	[15, 19],
	[20, 24],
	[25, 29],
	[30, 34],
	[35, 39],
	[40, 44],
	[45, 49],
	[50, 54],
	[55, 59],
	[60, 64],
	[65, 69],
	[70, 74],
	[75, 79],
	[80, 84],
	[85, 89],
	[90, 94],
	[95, 99]
]
strep_patients_age_group = occ.GetPatientAgeGroup(strep_patients, conn; age_groupings = age_groups)</code></pre><h3 id="Task:-Characterize-Each-Person-by-Gender,-Race,-and-Age-Group"><a class="docs-heading-anchor" href="#Task:-Characterize-Each-Person-by-Gender,-Race,-and-Age-Group">Task: Characterize Each Person by Gender, Race, and Age Group</a><a id="Task:-Characterize-Each-Person-by-Gender,-Race,-and-Age-Group-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Characterize-Each-Person-by-Gender,-Race,-and-Age-Group" title="Permalink"></a></h3><p>With the previous tasks, we now know patients&#39; gender, race, and age group. Using this information, combine these features to create a final table where each patient&#39;s <code>person_id</code>, gender, race, and age group is found in a given row. Hint: The DataFrames.jl <a href="https://dataframes.juliadata.org/stable/man/joins/">documentation section on joins</a> will be of strong use here.</p><p>Suggested solution:</p><pre><code class="language-julia hljs">import DataFrames as DF

strep_patients_characterized = DF.outerjoin(strep_patients_race, strep_patients_gender, strep_patients_age_group; on = :person_id, matchmissing = :equal)</code></pre><h3 id="Task:-Create-Patient-Groupings"><a class="docs-heading-anchor" href="#Task:-Create-Patient-Groupings">Task: Create Patient Groupings</a><a id="Task:-Create-Patient-Groupings-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Create-Patient-Groupings" title="Permalink"></a></h3><p>Often with characterization style studies, it is extremely important to aggregate patient populations. Why? To protect the anonymity of patients with perhaps severely sensitive conditions (e.g. mental illnesses, sexually transmitted diseases, etc.) from possible repercussions from accidental disclosure of this patient information.</p><p>For this task, add to the table you created in the previous task a new column called <code>counts</code> and remove the <code>person_id</code> column. The <code>counts</code> column should represent the total number of patients belonging to a group&#39;s gender, race, and age group. Here is an example on how to calculate <code>counts</code>: if there are <span>$5$</span> rows in your table that have patients who are between the ages of <span>$20 - 24$</span>, are African American, and are female, the value for that age, race, and gender group is <span>$5$</span>. The <span>$5$</span> rows would then collapse into <span>$1$</span> row as unique patient identifiers (the <code>person_id</code> column) would be removed. Hint: removing the <code>person_id</code> column first may make things easier; also, look at the <a href="https://dataframes.juliadata.org/stable/man/split_apply_combine/">DataFrames.jl documentation on the Split-Apply-Combine</a> approach to generate the <code>counts</code> column.</p><p>Suggested solution:</p><pre><code class="language-julia hljs">strep_patients_characterized = strep_patients_characterized[:, DF.Not(:person_id)]
strep_patient_groups = DF.groupby(strep_patients_characterized, [:race_concept_id, :gender_concept_id, :age_group])
strep_patient_groups = DF.combine(strep_patient_groups, DF.nrow =&gt; :counts)</code></pre><h3 id="Task:-Execute-Safety-Audit"><a class="docs-heading-anchor" href="#Task:-Execute-Safety-Audit">Task: Execute Safety Audit</a><a id="Task:-Execute-Safety-Audit-1"></a><a class="docs-heading-anchor-permalink" href="#Task:-Execute-Safety-Audit" title="Permalink"></a></h3><p>To ensure the safety of the patients in this table, we can execute an audit. One such auditing standard are those put forth by &quot;<a href="https://www.hhs.gov/hipaa/for-professionals/special-topics/hitech-act-enforcement-interim-final-rule/index.html">HITECH</a>&quot; which, amongst other things, requires researchers to filter out from a table patient counts <span>$&lt; 11$</span> in subpopulation groups â€“ the kind of groups we created! We can apply that as follows:</p><pre><code class="language-julia hljs">audited_strep_patient_groups = occ.ExecuteAudit(strep_patient_groups; hitech = true)</code></pre><h2 id="Conclusion"><a class="docs-heading-anchor" href="#Conclusion">Conclusion ğŸ‰</a><a id="Conclusion-1"></a><a class="docs-heading-anchor-permalink" href="#Conclusion" title="Permalink"></a></h2><p>This mini characterization study that we just conducted on this dataset opens up a whole new avenue for a researcher to pursue. For example, we could now calculate prevalence rates across different patient characteristics or compare and contrast multiple conditions at once. It should also be apparent that the API is set up in a very particular way: it is functional meaning that each function does one thing only. This gives a lot of flexibility to a user to build together study incrementally using OMOPCDMCohortCreator. Congratulations on finishing this tutorial and if there are any issues you encountered, <a href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl/issues/new/choose">feel free to open an issue here</a>!</p><h2 id="Appendix"><a class="docs-heading-anchor" href="#Appendix">Appendix ğŸ•µï¸</a><a id="Appendix-1"></a><a class="docs-heading-anchor-permalink" href="#Appendix" title="Permalink"></a></h2><h3 id="Packages-Used-in-Analysis"><a class="docs-heading-anchor" href="#Packages-Used-in-Analysis">Packages Used in Analysis</a><a id="Packages-Used-in-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Packages-Used-in-Analysis" title="Permalink"></a></h3><p>Package descriptions:</p><ul><li><p><a href="https://github.com/JuliaData/DataFrames.jl"><code>DataFrames</code></a> - Julia&#39;s dataframe handler for easily manipulating data</p></li><li><p><a href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl"><code>OMOPCDMCohortCreator</code></a> - Create cohorts from databases utilizing the OMOP CDM</p></li><li><p><a href="https://github.com/JuliaHealth/HealthSampleData.jl"><code>HealthSampleData</code></a> - Sample health data for a variety of health formats and use cases</p></li><li><p><a href="https://github.com/JuliaDatabases/SQLite.jl"><code>SQLite</code></a> - A Julia interface to the SQLite library</p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">Â« Tutorials</a><a class="docs-footer-nextpage" href="../r_tutorial/">Using OMOPCDMCohortCreator with R ğŸ´â€â˜ ï¸ Â»</a><div class="flexbox-break"></div><p class="footer-message">Created by <a href="https://jacobzelko.com">Jacob Zelko</a> &amp; <a href="https://www.gtri.gatech.edu">Georgia Tech Research Institute</a>. <a href="https://github.com/JuliaHealth/OMOPCDMCohortCreator.jl/blob/main/LICENSE">License</a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Monday 24 October 2022 02:30">Monday 24 October 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
